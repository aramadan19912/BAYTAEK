<div class="services-management">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <h1>{{ 'admin.services.title' | translate }}</h1>
      <p class="subtitle">{{ 'admin.services.subtitle' | translate }}</p>
    </div>
    <button class="btn-back" (click)="backToDashboard()">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M19 12H5M12 19l-7-7 7-7"/>
      </svg>
      {{ 'admin.services.back_to_dashboard' | translate }}
    </button>
  </div>

  <!-- Filters Section -->
  <div class="filters-section">
    <div class="filter-group">
      <!-- Search Box -->
      <div class="search-box">
        <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
        <input
          type="text"
          class="search-input"
          [placeholder]="'admin.services.search_placeholder' | translate"
          [value]="searchTerm"
          (input)="onSearch($event)"
        />
      </div>

      <!-- Category Filter -->
      <select class="filter-select" [value]="selectedCategory" (change)="onCategoryChange($event)">
        <option value="">{{ 'admin.services.all_categories' | translate }}</option>
        <option *ngFor="let category of categories" [value]="category.value">{{ category.label }}</option>
      </select>

      <!-- Status Filter -->
      <select class="filter-select" [value]="selectedStatus" (change)="onStatusChange($event)">
        <option value="">{{ 'admin.services.all_statuses' | translate }}</option>
        <option value="active">{{ 'status.active' | translate }}</option>
        <option value="inactive">{{ 'status.inactive' | translate }}</option>
      </select>

      <!-- Approval Status Filter -->
      <select class="filter-select" [value]="selectedApprovalStatus" (change)="onApprovalStatusChange($event)">
        <option value="">{{ 'admin.services.all_approvals' | translate }}</option>
        <option value="Pending">{{ 'admin.services.pending_approval' | translate }}</option>
        <option value="Approved">{{ 'admin.services.approved' | translate }}</option>
        <option value="Rejected">{{ 'admin.services.rejected' | translate }}</option>
      </select>

      <!-- Clear Filters Button -->
      <button class="btn-clear" (click)="clearFilters()">
        {{ 'admin.services.clear_filters' | translate }}
      </button>
    </div>

    <!-- Results Info -->
    <div class="results-info">
      {{ 'admin.services.showing' | translate }} {{ services.length }} {{ 'admin.services.of' | translate }} {{ totalCount }} {{ 'admin.services.services' | translate }}
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="spinner"></div>
    <p>{{ 'common.loading' | translate }}</p>
  </div>

  <!-- Services Table -->
  <div *ngIf="!isLoading && services.length > 0" class="table-container">
    <table class="services-table">
      <thead>
        <tr>
          <th>{{ 'admin.services.service' | translate }}</th>
          <th>{{ 'admin.services.provider' | translate }}</th>
          <th>{{ 'admin.services.category' | translate }}</th>
          <th>{{ 'admin.services.price' | translate }}</th>
          <th>{{ 'admin.services.approval_status' | translate }}</th>
          <th>{{ 'admin.services.status' | translate }}</th>
          <th>{{ 'admin.services.bookings' | translate }}</th>
          <th>{{ 'admin.services.rating' | translate }}</th>
          <th>{{ 'admin.services.created' | translate }}</th>
          <th>{{ 'admin.services.actions' | translate }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let service of services" class="service-row" (click)="viewServiceDetails(service)">
          <!-- Service Name -->
          <td class="service-name">
            <div class="name-cell">
              <div class="service-icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="3" width="7" height="7"></rect>
                  <rect x="14" y="3" width="7" height="7"></rect>
                  <rect x="14" y="14" width="7" height="7"></rect>
                  <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
              </div>
              <div>
                <div class="name">{{ service.name }}</div>
              </div>
            </div>
          </td>

          <!-- Provider -->
          <td>
            <div class="provider-cell">
              <div class="provider-avatar">{{ getProviderInitial(service.providerName) }}</div>
              <span>{{ service.providerName }}</span>
            </div>
          </td>

          <!-- Category -->
          <td>{{ service.categoryName }}</td>

          <!-- Price -->
          <td class="price">{{ formatCurrency(service.basePrice, service.currency) }}</td>

          <!-- Approval Status -->
          <td>
            <span class="approval-badge" [ngClass]="getApprovalStatusClass(service.approvalStatus)">
              {{ service.approvalStatus }}
            </span>
          </td>

          <!-- Active Status -->
          <td>
            <span class="status-badge" [ngClass]="service.isActive ? 'status-active' : 'status-inactive'">
              {{ service.isActive ? ('status.active' | translate) : ('status.inactive' | translate) }}
            </span>
          </td>

          <!-- Total Bookings -->
          <td class="bookings">{{ service.totalBookings }}</td>

          <!-- Rating -->
          <td class="rating">
            <div class="rating-cell">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="#fbbf24" stroke="none">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
              </svg>
              <span>{{ service.averageRating?.toFixed(1) || 'N/A' }}</span>
            </div>
          </td>

          <!-- Created Date -->
          <td class="date">{{ formatDate(service.createdAt) }}</td>

          <!-- Actions -->
          <td class="actions">
            <div class="action-buttons">
              <!-- Approve (if pending) -->
              <button
                *ngIf="service.approvalStatus === 'Pending'"
                class="btn-action btn-approve"
                (click)="approveService(service, $event)"
                [title]="'admin.services.approve' | translate"
              >
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
              </button>

              <!-- Reject (if pending) -->
              <button
                *ngIf="service.approvalStatus === 'Pending'"
                class="btn-action btn-reject"
                (click)="rejectService(service, $event)"
                [title]="'admin.services.reject' | translate"
              >
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="18" y1="6" x2="6" y2="18"></line>
                  <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
              </button>

              <!-- Activate (if inactive and approved) -->
              <button
                *ngIf="!service.isActive && service.approvalStatus === 'Approved'"
                class="btn-action btn-activate"
                (click)="activateService(service, $event)"
                [title]="'admin.services.activate' | translate"
              >
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                  <polyline points="22 4 12 14.01 9 11.01"></polyline>
                </svg>
              </button>

              <!-- Deactivate (if active) -->
              <button
                *ngIf="service.isActive"
                class="btn-action btn-deactivate"
                (click)="deactivateService(service, $event)"
                [title]="'admin.services.deactivate' | translate"
              >
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"></circle>
                  <line x1="15" y1="9" x2="9" y2="15"></line>
                  <line x1="9" y1="9" x2="15" y2="15"></line>
                </svg>
              </button>

              <!-- Edit -->
              <button
                class="btn-action btn-edit"
                (click)="editService(service, $event)"
                [title]="'common.edit' | translate"
              >
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                  <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                </svg>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && services.length === 0" class="empty-state">
    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
      <rect x="3" y="3" width="7" height="7"></rect>
      <rect x="14" y="3" width="7" height="7"></rect>
      <rect x="14" y="14" width="7" height="7"></rect>
      <rect x="3" y="14" width="7" height="7"></rect>
    </svg>
    <h3>{{ 'admin.services.no_services' | translate }}</h3>
    <p>{{ 'admin.services.no_services_desc' | translate }}</p>
  </div>

  <!-- Pagination -->
  <div *ngIf="!isLoading && totalCount > pageSize" class="pagination">
    <button class="btn-page" (click)="previousPage()" [disabled]="!hasPreviousPage">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M15 18l-6-6 6-6"/>
      </svg>
      {{ 'admin.services.previous' | translate }}
    </button>

    <span class="page-info">
      {{ 'admin.services.page' | translate }} {{ pageNumber }}
    </span>

    <button class="btn-page" (click)="nextPage()" [disabled]="!hasNextPage">
      {{ 'admin.services.next' | translate }}
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M9 18l6-6-6-6"/>
      </svg>
    </button>
  </div>
</div>
