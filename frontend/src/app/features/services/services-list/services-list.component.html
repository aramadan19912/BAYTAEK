<div class="services-container">
  <!-- Header -->
  <div class="services-header">
    <h1>{{ 'servicesList.title' | translate }}</h1>
    <p class="subtitle">{{ 'servicesList.subtitle' | translate }}</p>
  </div>

  <!-- Search and Filters -->
  <div class="search-filters">
    <!-- Search Box -->
    <div class="search-box">
      <input
        type="text"
        [(ngModel)]="searchTerm"
        (ngModelChange)="onSearchChange()"
        [placeholder]="'servicesList.search' | translate"
        class="search-input"
      />
    </div>

    <!-- Filter Bar -->
    <div class="filter-bar">
      <!-- Categories -->
      <div class="filter-group">
        <label>{{ 'servicesList.filters.category' | translate }}</label>
        <select [(ngModel)]="selectedCategoryId" (ngModelChange)="onCategoryChange($event)" class="filter-select">
          <option [value]="null">{{ 'servicesList.filters.allCategories' | translate }}</option>
          <option *ngFor="let category of categories; trackBy: trackByCategoryId" [value]="category.categoryId">
            {{ getCategoryName(category) }}
          </option>
        </select>
      </div>

      <!-- Region -->
      <div class="filter-group">
        <label>{{ 'servicesList.filters.region' | translate }}</label>
        <select [(ngModel)]="selectedRegion" (ngModelChange)="onRegionChange()" class="filter-select">
          <option [value]="null">{{ 'servicesList.filters.allRegions' | translate }}</option>
          <option *ngFor="let region of regions" [value]="region.value">
            {{ region.label }}
          </option>
        </select>
      </div>

      <!-- Price Range -->
      <div class="filter-group">
        <label>{{ 'servicesList.filters.minPrice' | translate }}</label>
        <input
          type="number"
          [(ngModel)]="minPrice"
          (ngModelChange)="onPriceFilterChange()"
          [placeholder]="'servicesList.filters.min' | translate"
          class="filter-input"
        />
      </div>

      <div class="filter-group">
        <label>{{ 'servicesList.filters.maxPrice' | translate }}</label>
        <input
          type="number"
          [(ngModel)]="maxPrice"
          (ngModelChange)="onPriceFilterChange()"
          [placeholder]="'servicesList.filters.max' | translate"
          class="filter-input"
        />
      </div>

      <!-- Rating -->
      <div class="filter-group">
        <label>{{ 'servicesList.filters.minRating' | translate }}</label>
        <select [(ngModel)]="minRating" (ngModelChange)="onRatingChange()" class="filter-select">
          <option [value]="null">{{ 'servicesList.filters.anyRating' | translate }}</option>
          <option *ngFor="let rating of ratingOptions" [value]="rating.value">
            {{ rating.label }}
          </option>
        </select>
      </div>

      <!-- Sort -->
      <div class="filter-group">
        <label>{{ 'servicesList.filters.sortBy' | translate }}</label>
        <select [(ngModel)]="sortBy" (ngModelChange)="onSortChange()" class="filter-select">
          <option *ngFor="let option of sortOptions" [value]="option.value">
            {{ option.label }}
          </option>
        </select>
      </div>

      <!-- Clear Filters -->
      <div class="filter-group">
        <label>&nbsp;</label>
        <button class="clear-btn" (click)="clearFilters()">
          {{ 'servicesList.filters.clear' | translate }}
        </button>
      </div>
    </div>
  </div>

  <!-- Results Info -->
  <div class="results-info" *ngIf="!loading">
    <p>{{ 'servicesList.found' | translate:{ count: totalCount } }}</p>
  </div>

  <!-- Services Grid -->
  <div class="services-grid" *ngIf="!loading && services.length > 0">
    <div
      *ngFor="let service of services; trackBy: trackByServiceId"
      class="service-card"
      [routerLink]="['/services', service.serviceId]"
    >
      <!-- Image -->
      <div class="service-image">
        <img
          [src]="service.images && service.images.length > 0 ? service.images[0] : 'assets/images/placeholder-service.jpg'"
          [alt]="getServiceName(service)"
        />
        <button
          class="favorite-btn"
          (click)="toggleFavorite(service.serviceId, $event)"
          [class.active]="isFavorite(service.serviceId)"
        >
          {{ isFavorite(service.serviceId) ? '‚ù§Ô∏è' : 'ü§ç' }}
        </button>
      </div>

      <!-- Content -->
      <div class="service-content">
        <h3>{{ getServiceName(service) }}</h3>

        <div class="service-meta">
          <div class="rating">
            <span class="stars">
              <span *ngFor="let filled of getStarArray(service.averageRating)" [class.filled]="filled">‚òÖ</span>
            </span>
            <span class="rating-text">{{ service.averageRating.toFixed(1) }} ({{ service.totalReviews }})</span>
          </div>
          <span class="service-category">{{ service.categoryName }}</span>
        </div>

        <div class="service-footer">
          <div class="price-info">
            <span class="price">{{ formatPrice(service.basePrice) }}</span>
            <span class="duration">~{{ service.estimatedDurationMinutes }} {{ 'servicesList.min' | translate }}</span>
          </div>

          <div class="provider-info">
            <span class="provider-name">{{ service.providerName }}</span>
            <span class="verified" *ngIf="service.isVerified">‚úì</span>
          </div>
        </div>

        <button class="book-btn" (click)="$event.preventDefault(); $event.stopPropagation()">
          {{ 'servicesList.bookNow' | translate }}
        </button>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="loading">
    <div class="spinner"></div>
    <p>{{ 'common.loading' | translate }}</p>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!loading && services.length === 0">
    <div class="empty-icon">üîç</div>
    <h2>{{ 'servicesList.empty.title' | translate }}</h2>
    <p>{{ 'servicesList.empty.description' | translate }}</p>
    <button class="btn btn-primary" (click)="clearFilters()">
      {{ 'servicesList.empty.clearFilters' | translate }}
    </button>
  </div>

  <!-- Pagination -->
  <div class="pagination" *ngIf="!loading && totalPages > 1">
    <button
      class="page-btn"
      (click)="previousPage()"
      [disabled]="currentPage === 1"
    >
      ‚Üê {{ 'pagination.previous' | translate }}
    </button>

    <button
      *ngFor="let page of paginationPages"
      class="page-btn"
      [class.active]="page === currentPage"
      (click)="goToPage(page)"
    >
      {{ page }}
    </button>

    <button
      class="page-btn"
      (click)="nextPage()"
      [disabled]="currentPage === totalPages"
    >
      {{ 'pagination.next' | translate }} ‚Üí
    </button>
  </div>
</div>
