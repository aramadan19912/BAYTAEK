<div class="services-container">
  <!-- Header -->
  <div class="services-header">
    <h1>Browse Services</h1>
    <p class="subtitle">Find the perfect service for your needs</p>
  </div>

  <!-- Search and Filters -->
  <div class="search-filters">
    <!-- Search Box -->
    <div class="search-box">
      <input
        type="text"
        [(ngModel)]="searchTerm"
        (ngModelChange)="onSearchChange()"
        placeholder="Search services..."
        class="search-input"
      />
    </div>

    <!-- Filter Bar -->
    <div class="filter-bar">
      <!-- Categories -->
      <div class="filter-group">
        <label>Category</label>
        <select [(ngModel)]="selectedCategoryId" (ngModelChange)="onCategoryChange($event)" class="filter-select">
          <option [value]="null">All Categories</option>
          <option *ngFor="let category of categories; trackBy: trackByCategoryId" [value]="category.categoryId">
            {{ getCategoryName(category) }}
          </option>
        </select>
      </div>

      <!-- Region -->
      <div class="filter-group">
        <label>Region</label>
        <select [(ngModel)]="selectedRegion" (ngModelChange)="onRegionChange()" class="filter-select">
          <option [value]="null">All Regions</option>
          <option *ngFor="let region of regions" [value]="region.value">
            {{ region.label }}
          </option>
        </select>
      </div>

      <!-- Price Range -->
      <div class="filter-group">
        <label>Min Price</label>
        <input
          type="number"
          [(ngModel)]="minPrice"
          (ngModelChange)="onPriceFilterChange()"
          placeholder="Min"
          class="filter-input"
        />
      </div>

      <div class="filter-group">
        <label>Max Price</label>
        <input
          type="number"
          [(ngModel)]="maxPrice"
          (ngModelChange)="onPriceFilterChange()"
          placeholder="Max"
          class="filter-input"
        />
      </div>

      <!-- Rating -->
      <div class="filter-group">
        <label>Min Rating</label>
        <select [(ngModel)]="minRating" (ngModelChange)="onRatingChange()" class="filter-select">
          <option [value]="null">Any Rating</option>
          <option *ngFor="let rating of ratingOptions" [value]="rating.value">
            {{ rating.label }}
          </option>
        </select>
      </div>

      <!-- Sort -->
      <div class="filter-group">
        <label>Sort By</label>
        <select [(ngModel)]="sortBy" (ngModelChange)="onSortChange()" class="filter-select">
          <option *ngFor="let option of sortOptions" [value]="option.value">
            {{ option.label }}
          </option>
        </select>
      </div>

      <!-- Clear Filters -->
      <div class="filter-group">
        <label>&nbsp;</label>
        <button class="clear-btn" (click)="clearFilters()">
          Clear Filters
        </button>
      </div>
    </div>
  </div>

  <!-- Results Info -->
  <div class="results-info" *ngIf="!loading">
    <p>Found {{ totalCount }} service{{ totalCount !== 1 ? 's' : '' }}</p>
  </div>

  <!-- Services Grid -->
  <div class="services-grid" *ngIf="!loading && services.length > 0">
    <div
      *ngFor="let service of services; trackBy: trackByServiceId"
      class="service-card"
      [routerLink]="['/services', service.serviceId]"
    >
      <!-- Image -->
      <div class="service-image">
        <img
          [src]="service.images && service.images.length > 0 ? service.images[0] : 'assets/images/placeholder-service.jpg'"
          [alt]="getServiceName(service)"
        />
        <button
          class="favorite-btn"
          (click)="toggleFavorite(service.serviceId, $event)"
          [class.active]="isFavorite(service.serviceId)"
        >
          {{ isFavorite(service.serviceId) ? '‚ù§Ô∏è' : 'ü§ç' }}
        </button>
      </div>

      <!-- Content -->
      <div class="service-content">
        <h3>{{ getServiceName(service) }}</h3>

        <div class="service-meta">
          <div class="rating">
            <span class="stars">
              <span *ngFor="let filled of getStarArray(service.averageRating)" [class.filled]="filled">‚òÖ</span>
            </span>
            <span class="rating-text">{{ service.averageRating.toFixed(1) }} ({{ service.totalReviews }})</span>
          </div>
          <span class="service-category">{{ service.categoryName }}</span>
        </div>

        <div class="service-footer">
          <div class="price-info">
            <span class="price">{{ formatPrice(service.basePrice) }}</span>
            <span class="duration">~{{ service.estimatedDurationMinutes }} min</span>
          </div>

          <div class="provider-info">
            <span class="provider-name">{{ service.providerName }}</span>
            <span class="verified" *ngIf="service.isVerified">‚úì</span>
          </div>
        </div>

        <button class="book-btn" (click)="$event.preventDefault(); $event.stopPropagation()">
          Book Now
        </button>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="loading">
    <div class="spinner"></div>
    <p>Loading services...</p>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!loading && services.length === 0">
    <div class="empty-icon">üîç</div>
    <h2>No Services Found</h2>
    <p>Try adjusting your search criteria or filters.</p>
    <button class="btn btn-primary" (click)="clearFilters()">
      Clear All Filters
    </button>
  </div>

  <!-- Pagination -->
  <div class="pagination" *ngIf="!loading && totalPages > 1">
    <button
      class="page-btn"
      (click)="previousPage()"
      [disabled]="currentPage === 1"
    >
      ‚Üê Previous
    </button>

    <button
      *ngFor="let page of paginationPages"
      class="page-btn"
      [class.active]="page === currentPage"
      (click)="goToPage(page)"
    >
      {{ page }}
    </button>

    <button
      class="page-btn"
      (click)="nextPage()"
      [disabled]="currentPage === totalPages"
    >
      Next ‚Üí
    </button>
  </div>
</div>
