<div class="provider-dashboard">
  <!-- Header -->
  <div class="dashboard-header">
    <div class="welcome-section">
      <h1>Provider Dashboard</h1>
      <p *ngIf="profile">Welcome back, {{ profile.businessName }}!</p>
    </div>

    <!-- Verification Status Alert -->
    <div *ngIf="profile && needsAttention()" class="verification-alert" [class]="getVerificationStatusClass(profile.verificationStatus)">
      <span class="alert-icon">‚ö†Ô∏è</span>
      <div class="alert-content">
        <strong>{{ getVerificationStatusLabel(profile.verificationStatus) }}</strong>
        <p *ngIf="profile.verificationStatus === 'Pending'">
          Please complete your profile and submit verification documents to start offering services.
        </p>
        <p *ngIf="profile.verificationStatus === 'Rejected'">
          {{ profile.verificationNotes }}
        </p>
      </div>
      <button class="btn btn-primary" routerLink="/profile">Complete Profile</button>
    </div>

    <!-- Profile Completion -->
    <div *ngIf="profile && getProfileCompletion() < 100" class="completion-card">
      <div class="completion-header">
        <h3>Profile Completion</h3>
        <span class="completion-percentage">{{ getProfileCompletion() }}%</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="getProfileCompletion()"></div>
      </div>
      <p class="completion-text">Complete your profile to attract more customers</p>
    </div>
  </div>

  <!-- Quick Stats -->
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-icon">üìÖ</div>
      <div class="stat-content">
        <span class="stat-label">Today's Bookings</span>
        <span class="stat-value">{{ todayBookings }}</span>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">‚è≥</div>
      <div class="stat-content">
        <span class="stat-label">Pending Bookings</span>
        <span class="stat-value">{{ pendingBookings }}</span>
      </div>
      <button class="stat-action" (click)="navigateToBookings()">View All</button>
    </div>

    <div class="stat-card">
      <div class="stat-icon">üí∞</div>
      <div class="stat-content">
        <span class="stat-label">This Week's Earnings</span>
        <span class="stat-value">{{ formatCurrency(weekEarnings) }}</span>
      </div>
      <button class="stat-action" (click)="navigateToEarnings()">Details</button>
    </div>

    <div class="stat-card">
      <div class="stat-icon">‚≠ê</div>
      <div class="stat-content">
        <span class="stat-label">Average Rating</span>
        <span class="stat-value">{{ stats?.averageRating || 0 }}</span>
      </div>
      <button class="stat-action" (click)="navigateToReviews()">View Reviews</button>
    </div>

    <div class="stat-card">
      <div class="stat-icon">üõéÔ∏è</div>
      <div class="stat-content">
        <span class="stat-label">Active Services</span>
        <span class="stat-value">{{ activeServicesCount }}</span>
      </div>
      <button class="stat-action" (click)="navigateToServices()">Manage</button>
    </div>

    <div class="stat-card">
      <div class="stat-icon">‚úÖ</div>
      <div class="stat-content">
        <span class="stat-label">Total Completed</span>
        <span class="stat-value">{{ stats?.completedBookings || 0 }}</span>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="dashboard-content">
    <!-- Recent Bookings -->
    <div class="content-section">
      <div class="section-header">
        <h2>Recent Bookings</h2>
        <button class="btn btn-secondary" (click)="navigateToBookings()">View All</button>
      </div>

      <!-- Loading State -->
      <div *ngIf="isLoadingBookings" class="loading-container">
        <div class="spinner"></div>
        <p>Loading bookings...</p>
      </div>

      <!-- Empty State -->
      <div *ngIf="!isLoadingBookings && recentBookings.length === 0" class="empty-state">
        <div class="empty-icon">üìã</div>
        <h3>No Recent Bookings</h3>
        <p>Your recent booking requests will appear here</p>
      </div>

      <!-- Bookings List -->
      <div *ngIf="!isLoadingBookings && recentBookings.length > 0" class="bookings-list">
        <div *ngFor="let booking of recentBookings" class="booking-card" (click)="viewBookingDetail(booking.bookingId)">
          <div class="booking-header">
            <div class="booking-info">
              <h4>{{ booking.serviceName }}</h4>
              <p class="booking-number">Booking #{{ booking.bookingNumber }}</p>
            </div>
            <span class="status-badge" [class]="getBookingStatusClass(booking.status)">
              {{ getBookingStatusLabel(booking.status) }}
            </span>
          </div>

          <div class="booking-details">
            <div class="detail-item">
              <span class="icon">üë§</span>
              <span>{{ booking.customerName }}</span>
            </div>
            <div class="detail-item">
              <span class="icon">üìÖ</span>
              <span>{{ formatDate(booking.scheduledDate) }}</span>
            </div>
            <div class="detail-item">
              <span class="icon">üïê</span>
              <span>{{ formatTime(booking.scheduledTime) }}</span>
            </div>
            <div class="detail-item">
              <span class="icon">üíµ</span>
              <span>{{ formatCurrency(booking.totalPrice) }}</span>
            </div>
          </div>

          <div class="booking-actions" *ngIf="booking.status === 'Pending'">
            <button class="btn btn-sm btn-success" (click)="$event.stopPropagation()">Accept</button>
            <button class="btn btn-sm btn-danger" (click)="$event.stopPropagation()">Reject</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Active Services -->
    <div class="content-section">
      <div class="section-header">
        <h2>Active Services</h2>
        <div class="header-actions">
          <button class="btn btn-primary" (click)="navigateToAddService()">Add New Service</button>
          <button class="btn btn-secondary" (click)="navigateToServices()">View All</button>
        </div>
      </div>

      <!-- Loading State -->
      <div *ngIf="isLoadingServices" class="loading-container">
        <div class="spinner"></div>
        <p>Loading services...</p>
      </div>

      <!-- Empty State -->
      <div *ngIf="!isLoadingServices && activeServices.length === 0" class="empty-state">
        <div class="empty-icon">üõéÔ∏è</div>
        <h3>No Active Services</h3>
        <p>Start adding services to receive booking requests</p>
        <button class="btn btn-primary" (click)="navigateToAddService()">Add Your First Service</button>
      </div>

      <!-- Services Grid -->
      <div *ngIf="!isLoadingServices && activeServices.length > 0" class="services-grid">
        <div *ngFor="let service of activeServices" class="service-card" (click)="viewServiceDetail(service.serviceId)">
          <div class="service-image">
            <img [src]="service.images && service.images[0] || 'assets/images/default-service.png'" [alt]="service.name">
            <span class="service-status">Active</span>
          </div>
          <div class="service-content">
            <h4>{{ service.name }}</h4>
            <div class="service-meta">
              <span class="price">{{ formatCurrency(service.price) }}</span>
              <span class="rating">
                <span class="stars">‚≠ê</span>
                {{ service.averageRating || 0 }}
              </span>
            </div>
            <div class="service-stats">
              <span>{{ service.totalBookings || 0 }} bookings</span>
              <span>{{ service.totalReviews || 0 }} reviews</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="quick-actions">
    <h2>Quick Actions</h2>
    <div class="actions-grid">
      <button class="action-card" (click)="navigateToAddService()">
        <span class="action-icon">‚ûï</span>
        <span class="action-label">Add New Service</span>
      </button>
      <button class="action-card" (click)="navigateToBookings()">
        <span class="action-icon">üìã</span>
        <span class="action-label">View Bookings</span>
      </button>
      <button class="action-card" (click)="navigateToEarnings()">
        <span class="action-icon">üí∞</span>
        <span class="action-label">View Earnings</span>
      </button>
      <button class="action-card" (click)="navigateToReviews()">
        <span class="action-icon">‚≠ê</span>
        <span class="action-label">Manage Reviews</span>
      </button>
    </div>
  </div>

  <!-- Performance Overview -->
  <div *ngIf="stats" class="performance-section">
    <h2>Performance Overview</h2>
    <div class="performance-grid">
      <div class="performance-card">
        <h3>Monthly Stats</h3>
        <div class="stats-list">
          <div class="stat-row">
            <span class="label">Total Bookings</span>
            <span class="value">{{ stats.monthlyBookings || 0 }}</span>
          </div>
          <div class="stat-row">
            <span class="label">Completed</span>
            <span class="value success">{{ stats.completedBookings || 0 }}</span>
          </div>
          <div class="stat-row">
            <span class="label">Cancelled</span>
            <span class="value danger">{{ stats.cancelledBookings || 0 }}</span>
          </div>
          <div class="stat-row">
            <span class="label">Earnings</span>
            <span class="value">{{ formatCurrency(stats.monthlyEarnings || 0) }}</span>
          </div>
        </div>
      </div>

      <div class="performance-card">
        <h3>Customer Satisfaction</h3>
        <div class="stats-list">
          <div class="stat-row">
            <span class="label">Average Rating</span>
            <span class="value">{{ stats.averageRating || 0 }} ‚≠ê</span>
          </div>
          <div class="stat-row">
            <span class="label">Total Reviews</span>
            <span class="value">{{ stats.totalReviews || 0 }}</span>
          </div>
          <div class="stat-row">
            <span class="label">Positive Reviews</span>
            <span class="value success">{{ stats.positiveReviews || 0 }}</span>
          </div>
          <div class="stat-row">
            <span class="label">Response Rate</span>
            <span class="value">{{ stats.responseRate || 0 }}%</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
