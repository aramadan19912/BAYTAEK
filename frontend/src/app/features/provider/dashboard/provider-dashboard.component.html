<div class="provider-dashboard">
  <!-- Header -->
  <div class="dashboard-header">
    <div class="welcome-section">
      <h1>{{ 'provider.dashboard.title' | translate }}</h1>
      <p *ngIf="profile">{{ 'provider.dashboard.welcome' | translate:{ name: profile.businessName } }}</p>
    </div>

    <!-- Verification Status Alert -->
    <div *ngIf="profile && needsAttention()" class="verification-alert" [class]="getVerificationStatusClass(profile.verificationStatus)">
      <span class="alert-icon">‚ö†Ô∏è</span>
      <div class="alert-content">
        <strong>{{ getVerificationStatusLabel(profile.verificationStatus) }}</strong>
        <p *ngIf="profile.verificationStatus === 'Pending'">
          {{ 'provider.dashboard.verification.pending' | translate }}
        </p>
        <p *ngIf="profile.verificationStatus === 'Rejected'">
          {{ profile.verificationNotes }}
        </p>
      </div>
      <button class="btn btn-primary" routerLink="/profile">
        {{ 'provider.dashboard.verification.completeProfile' | translate }}
      </button>
    </div>

    <!-- Profile Completion -->
    <div *ngIf="profile && getProfileCompletion() < 100" class="completion-card">
      <div class="completion-header">
        <h3>{{ 'provider.dashboard.profileCompletion.title' | translate }}</h3>
        <span class="completion-percentage">{{ getProfileCompletion() }}%</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="getProfileCompletion()"></div>
      </div>
      <p class="completion-text">{{ 'provider.dashboard.profileCompletion.description' | translate }}</p>
    </div>
  </div>

  <!-- Quick Stats -->
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-icon">üìÖ</div>
      <div class="stat-content">
        <span class="stat-label">{{ 'provider.dashboard.stats.todayBookings' | translate }}</span>
        <span class="stat-value">{{ todayBookings }}</span>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">‚è≥</div>
      <div class="stat-content">
        <span class="stat-label">{{ 'provider.dashboard.stats.pending' | translate }}</span>
        <span class="stat-value">{{ pendingBookings }}</span>
      </div>
      <button class="stat-action" (click)="navigateToBookings()">
        {{ 'provider.dashboard.actions.viewAll' | translate }}
      </button>
    </div>

    <div class="stat-card">
      <div class="stat-icon">üí∞</div>
      <div class="stat-content">
        <span class="stat-label">{{ 'provider.dashboard.stats.weekEarnings' | translate }}</span>
        <span class="stat-value">{{ formatCurrency(weekEarnings) }}</span>
      </div>
      <button class="stat-action" (click)="navigateToEarnings()">
        {{ 'provider.dashboard.actions.details' | translate }}
      </button>
    </div>

    <div class="stat-card">
      <div class="stat-icon">‚≠ê</div>
      <div class="stat-content">
        <span class="stat-label">{{ 'provider.dashboard.stats.avgRating' | translate }}</span>
        <span class="stat-value">{{ stats?.averageRating || 0 }}</span>
      </div>
      <button class="stat-action" (click)="navigateToReviews()">
        {{ 'provider.dashboard.actions.viewReviews' | translate }}
      </button>
    </div>

    <div class="stat-card">
      <div class="stat-icon">üõéÔ∏è</div>
      <div class="stat-content">
        <span class="stat-label">{{ 'provider.dashboard.stats.activeServices' | translate }}</span>
        <span class="stat-value">{{ activeServicesCount }}</span>
      </div>
      <button class="stat-action" (click)="navigateToServices()">
        {{ 'provider.dashboard.actions.manage' | translate }}
      </button>
    </div>

    <div class="stat-card">
      <div class="stat-icon">‚úÖ</div>
      <div class="stat-content">
        <span class="stat-label">{{ 'provider.dashboard.stats.completed' | translate }}</span>
        <span class="stat-value">{{ stats?.completedBookings || 0 }}</span>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="dashboard-content">
    <!-- Recent Bookings -->
    <div class="content-section">
      <div class="section-header">
        <h2>{{ 'provider.dashboard.sections.recentBookings' | translate }}</h2>
        <button class="btn btn-secondary" (click)="navigateToBookings()">
          {{ 'provider.dashboard.actions.viewAll' | translate }}
        </button>
      </div>

      <!-- Loading State -->
      <div *ngIf="isLoadingBookings" class="loading-container">
        <div class="spinner"></div>
        <p>{{ 'common.loading' | translate }}</p>
      </div>

      <!-- Empty State -->
      <div *ngIf="!isLoadingBookings && recentBookings.length === 0" class="empty-state">
        <div class="empty-icon">üìã</div>
        <h3>{{ 'provider.dashboard.empty.noBookings' | translate }}</h3>
        <p>{{ 'provider.dashboard.empty.noBookingsDesc' | translate }}</p>
      </div>

      <!-- Bookings List -->
      <div *ngIf="!isLoadingBookings && recentBookings.length > 0" class="bookings-list">
        <div *ngFor="let booking of recentBookings" class="booking-card" (click)="viewBookingDetail(booking.bookingId)">
          <div class="booking-header">
            <div class="booking-info">
              <h4>{{ booking.serviceName }}</h4>
              <p class="booking-number">{{ 'provider.bookings.bookingNumber' | translate }} #{{ booking.bookingNumber }}</p>
            </div>
            <span class="status-badge" [class]="getBookingStatusClass(booking.status)">
              {{ 'status.' + booking.status.toLowerCase() | translate }}
            </span>
          </div>

          <div class="booking-details">
            <div class="detail-item">
              <span class="icon">üë§</span>
              <span>{{ booking.customerName }}</span>
            </div>
            <div class="detail-item">
              <span class="icon">üìÖ</span>
              <span>{{ formatDate(booking.scheduledDate) }}</span>
            </div>
            <div class="detail-item">
              <span class="icon">üïê</span>
              <span>{{ formatTime(booking.scheduledTime) }}</span>
            </div>
            <div class="detail-item">
              <span class="icon">üíµ</span>
              <span>{{ formatCurrency(booking.totalPrice) }}</span>
            </div>
          </div>

          <div class="booking-actions" *ngIf="booking.status === 'Pending'">
            <button class="btn btn-sm btn-success" (click)="$event.stopPropagation()">
              {{ 'provider.bookings.actions.accept' | translate }}
            </button>
            <button class="btn btn-sm btn-danger" (click)="$event.stopPropagation()">
              {{ 'provider.bookings.actions.reject' | translate }}
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Active Services -->
    <div class="content-section">
      <div class="section-header">
        <h2>{{ 'provider.dashboard.sections.activeServices' | translate }}</h2>
        <div class="header-actions">
          <button class="btn btn-primary" (click)="navigateToAddService()">
            {{ 'provider.dashboard.actions.addService' | translate }}
          </button>
          <button class="btn btn-secondary" (click)="navigateToServices()">
            {{ 'provider.dashboard.actions.viewAll' | translate }}
          </button>
        </div>
      </div>

      <!-- Loading State -->
      <div *ngIf="isLoadingServices" class="loading-container">
        <div class="spinner"></div>
        <p>{{ 'common.loading' | translate }}</p>
      </div>

      <!-- Empty State -->
      <div *ngIf="!isLoadingServices && activeServices.length === 0" class="empty-state">
        <div class="empty-icon">üõéÔ∏è</div>
        <h3>{{ 'provider.dashboard.empty.noServices' | translate }}</h3>
        <p>{{ 'provider.dashboard.empty.noServicesDesc' | translate }}</p>
        <button class="btn btn-primary" (click)="navigateToAddService()">
          {{ 'provider.dashboard.empty.addFirst' | translate }}
        </button>
      </div>

      <!-- Services Grid -->
      <div *ngIf="!isLoadingServices && activeServices.length > 0" class="services-grid">
        <div *ngFor="let service of activeServices" class="service-card" (click)="viewServiceDetail(service.serviceId)">
          <div class="service-image">
            <img [src]="service.images && service.images[0] || 'assets/images/default-service.png'" [alt]="service.name">
            <span class="service-status">{{ 'status.active' | translate }}</span>
          </div>
          <div class="service-content">
            <h4>{{ service.name }}</h4>
            <div class="service-meta">
              <span class="price">{{ formatCurrency(service.price) }}</span>
              <span class="rating">
                <span class="stars">‚≠ê</span>
                {{ service.averageRating || 0 }}
              </span>
            </div>
            <div class="service-stats">
              <span>{{ service.totalBookings || 0 }} {{ 'provider.services.stats.bookings' | translate }}</span>
              <span>{{ service.totalReviews || 0 }} {{ 'provider.services.stats.reviews' | translate }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="quick-actions">
    <h2>{{ 'provider.dashboard.sections.quickActions' | translate }}</h2>
    <div class="actions-grid">
      <button class="action-card" (click)="navigateToAddService()">
        <span class="action-icon">‚ûï</span>
        <span class="action-label">{{ 'provider.dashboard.quickActions.addService' | translate }}</span>
      </button>
      <button class="action-card" (click)="navigateToBookings()">
        <span class="action-icon">üìã</span>
        <span class="action-label">{{ 'provider.dashboard.quickActions.viewBookings' | translate }}</span>
      </button>
      <button class="action-card" (click)="navigateToEarnings()">
        <span class="action-icon">üí∞</span>
        <span class="action-label">{{ 'provider.dashboard.quickActions.viewEarnings' | translate }}</span>
      </button>
      <button class="action-card" (click)="navigateToReviews()">
        <span class="action-icon">‚≠ê</span>
        <span class="action-label">{{ 'provider.dashboard.quickActions.manageReviews' | translate }}</span>
      </button>
    </div>
  </div>

  <!-- Performance Overview -->
  <div *ngIf="stats" class="performance-section">
    <h2>{{ 'provider.dashboard.sections.performance' | translate }}</h2>
    <div class="performance-grid">
      <div class="performance-card">
        <h3>{{ 'provider.dashboard.performance.monthly' | translate }}</h3>
        <div class="stats-list">
          <div class="stat-row">
            <span class="label">{{ 'provider.dashboard.performance.totalBookings' | translate }}</span>
            <span class="value">{{ stats.monthlyBookings || 0 }}</span>
          </div>
          <div class="stat-row">
            <span class="label">{{ 'provider.dashboard.performance.completedBookings' | translate }}</span>
            <span class="value success">{{ stats.completedBookings || 0 }}</span>
          </div>
          <div class="stat-row">
            <span class="label">{{ 'provider.dashboard.performance.cancelledBookings' | translate }}</span>
            <span class="value danger">{{ stats.cancelledBookings || 0 }}</span>
          </div>
          <div class="stat-row">
            <span class="label">{{ 'provider.dashboard.performance.earnings' | translate }}</span>
            <span class="value">{{ formatCurrency(stats.monthlyEarnings || 0) }}</span>
          </div>
        </div>
      </div>

      <div class="performance-card">
        <h3>{{ 'provider.dashboard.performance.customerSatisfaction' | translate }}</h3>
        <div class="stats-list">
          <div class="stat-row">
            <span class="label">{{ 'provider.dashboard.performance.avgRating' | translate }}</span>
            <span class="value">{{ stats.averageRating || 0 }} ‚≠ê</span>
          </div>
          <div class="stat-row">
            <span class="label">{{ 'provider.dashboard.performance.totalReviews' | translate }}</span>
            <span class="value">{{ stats.totalReviews || 0 }}</span>
          </div>
          <div class="stat-row">
            <span class="label">{{ 'provider.dashboard.performance.positiveReviews' | translate }}</span>
            <span class="value success">{{ stats.positiveReviews || 0 }}</span>
          </div>
          <div class="stat-row">
            <span class="label">{{ 'provider.dashboard.performance.responseRate' | translate }}</span>
            <span class="value">{{ stats.responseRate || 0 }}%</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
